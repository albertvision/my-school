<!DOCTYPE html>
<html th:replace="~{base :: layout(~{::body})}" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Teacher Education Subjects</title>
</head>
<body>
<div class="container">
    <div class="page-header">
        <h1 th:text="${title}"></h1>
        <!--        <p>-->
        <!--            <a href="javascript:void(0);" id="addNewTeachEducButton"  onclick="addNewRow()" class="btn btn-primary btn-sm">Добавяне на нов</a>-->
        <!--        </p>-->
    <p th:if="${result} != null"
       th:class="'alert alert-' + ${result.type().getUiClass()}"
       th:text="${result.message()}"/>

    <br th:if="${school == null}">
    <!-- Display selected school name -->
    <div class="container mt-3" th:if="${school != null}">
        <h2 class="font-weight-bold" th:text="${school.name}"></h2>
    </div>

    <form th:action="@{/teachEduc}" method="post">
        <div class="form-group">
            <label for="teacherId">Избери учител</label>
            <select id="teacherId" name="teacherId" class="form-control" required>
                <option value="">Избери...</option>
                <option th:each="teacher : ${teachers}" th:value="${teacher.id}"
                        th:selected="${teacher} == ${selectedTeacher}"
                        th:text="${teacher.id + ' - ' + teacher.name}"></option>
            </select>
        </div>
        <button type="submit" class="btn btn-primary">Избери</button>
    </form>
    </div>

<!--    table displaying objects-->
    <div th:if="${school != null} and ${selectedTeacher != null}" class="panel panel-default">
        <div class="table-responsive">
            <table id="teachEducTable" th:if="${school != null} and ${selectedTeacher != null}" class="table table-bordered table-hover table-striped">
                <thead>
                <tr>
                    <th>#</th>
                    <th>Име</th>
                    <th>Преподава</th>
                </tr>
                </thead>
                <tbody id="teachEducTableBody">
<!--                form behavior: schoolId is from session (1), teacherId is from dropdown (1) and classes are many -->
                <tr th:each="schoolEducObj : ${schoolEducObjs}">

                    <td th:text="${schoolEducObj.id}"></td>
                    <td th:id="'name-'+${schoolEducObj.id}" th:text="${schoolEducObj.name}"></td>
                    <!--                    checkbox -->
                    <td>
                        <label>
                            <input type="checkbox"  th:id="'checkbox'+${schoolEducObj.id}" th:name="educObjIds" th:value="${schoolEducObj.id}"
                                   th:checked="${schoolTeacherEducObjs.contains(schoolEducObj)}"
                                   th:form="teachEducForm" />
                        </label>
                    </td>
                </tr>

                </tbody>
            </table>

        </div>
    </div>
    <form id="teachEducForm" th:action="@{/teachEduc/updateSubjects}" method="post" th:if="${selectedTeacher!=null}">
        <input type="hidden" name="schoolId" th:value="${school.id}"/>
        <input type="hidden" name="teacherId" th:value="${selectedTeacher.id}"/>
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
        <button type="submit" class="btn btn-primary">Потвърди предмети</button>
            </form>
</div>
<!--<script src="/js/teachEduc.js"></script>-->

</body>
</html>
